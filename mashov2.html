<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××©×•×‘ 2 â€” ×˜×›× ×•×“×¢</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --pink: #E6007E; --teal: #00B4C5; --orange: #F39200;
            --purple: #6D3078; --blue: #0080C9; --green: #78B82A;
            --yellow: #FDC300; --dark: #122231;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Heebo', sans-serif; background: #f8f9fc; color: var(--dark); min-height: 100vh; overflow-x: hidden; }

        .bg-logo {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 92vmin; height: 92vmin;
            z-index: 0; pointer-events: none; opacity: 0.30;
        }
        .bg-logo svg { width: 100%; height: 100%; }
        .bg-logo .logo-part { transition: fill 0.7s ease; }

        .container { position: relative; z-index: 1; max-width: 480px; margin: 0 auto; padding: 20px 16px 40px; }

        .header { text-align: center; margin-bottom: 24px; animation: slideDown 0.6s ease-out; }
        @keyframes slideDown { from { opacity:0; transform:translateY(-30px); } to { opacity:1; transform:translateY(0); } }
        .header .logo { width: 90px; height: auto; margin-bottom: 12px; filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1)); }
        .header h1 { font-size: 1.5rem; font-weight: 900; background: linear-gradient(135deg, var(--teal), var(--blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 4px; }
        .header .subtitle { font-size: 0.85rem; color: #888; font-weight: 300; }

        .progress-wrapper { margin-bottom: 24px; animation: slideDown 0.6s ease-out 0.1s both; }
        .progress-bar { height: 6px; background: #e8e8e8; border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--teal), var(--blue), var(--purple), var(--pink)); background-size: 300% 100%; border-radius: 3px; transition: width 0.5s cubic-bezier(0.4,0,0.2,1); animation: shimmer 3s ease-in-out infinite; width: 0%; }
        @keyframes shimmer { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
        .progress-text { display: flex; justify-content: space-between; margin-top: 6px; font-size: 0.75rem; color: #aaa; }

        .intro-card { background: linear-gradient(135deg, var(--green), var(--teal)); color: white; border-radius: 20px; padding: 24px 20px; margin-bottom: 24px; text-align: center; position: relative; overflow: hidden; animation: fadeUp 0.6s ease-out 0.2s both; }
        .intro-card::before { content:''; position:absolute; top:-30px; right:-30px; width:100px; height:100px; background:rgba(255,255,255,0.1); border-radius:50%; }
        .intro-card .emoji { font-size: 2rem; margin-bottom: 8px; animation: bounce 2s ease-in-out infinite; }
        @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }
        .intro-card p { font-size: 0.95rem; line-height: 1.6; position: relative; z-index: 1; }
        @keyframes fadeUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }

        .question-slide { display: none; animation: fadeUp 0.4s ease-out; }
        .question-slide.active { display: block; }

        .question-card { background: rgba(255,255,255,0.92); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: 20px; padding: 24px 20px; box-shadow: 0 4px 24px rgba(0,0,0,0.06); margin-bottom: 16px; }
        .question-number { display: inline-flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: 50%; font-size: 0.85rem; font-weight: 700; color: white; margin-bottom: 12px; }
        .q-color-1{background:var(--teal)} .q-color-2{background:var(--blue)} .q-color-3{background:var(--purple)} .q-color-4{background:var(--orange)} .q-color-5{background:var(--green)} .q-color-6{background:var(--pink)}
        .question-card h2 { font-size: 1.05rem; font-weight: 700; line-height: 1.6; margin-bottom: 20px; color: var(--dark); }

        .star-rating { display: flex; justify-content: center; gap: 8px; direction: rtl; }
        .star-rating .star { font-size: 2.5rem; cursor: pointer; transition: all 0.2s ease; color: #ddd; -webkit-tap-highlight-color: transparent; user-select: none; }
        .star-rating .star:hover, .star-rating .star.hovered { transform: scale(1.2); }
        .star-rating .star.active { animation: starPop 0.3s ease-out; }
        @keyframes starPop { 0%{transform:scale(1)} 50%{transform:scale(1.4)} 100%{transform:scale(1.1)} }
        .star-label { text-align: center; margin-top: 10px; font-size: 0.85rem; color: #999; min-height: 20px; transition: all 0.2s; }
        .star-label.visible { color: var(--dark); font-weight: 500; }

        .option-group { display: flex; flex-direction: column; gap: 10px; }
        .option-btn { display: flex; align-items: center; gap: 12px; padding: 14px 18px; border: 2px solid #eee; border-radius: 14px; background: white; cursor: pointer; transition: all 0.25s; font-family: 'Heebo', sans-serif; font-size: 0.95rem; -webkit-tap-highlight-color: transparent; }
        .option-btn:active { transform: scale(0.97); }
        .option-btn .circle { width: 22px; height: 22px; border-radius: 50%; border: 2px solid #ddd; transition: all 0.25s; flex-shrink: 0; position: relative; }
        .option-btn.selected { border-color: var(--teal); background: rgba(0,180,197,0.05); }
        .option-btn.selected .circle { border-color: var(--teal); background: var(--teal); }
        .option-btn.selected .circle::after { content: '\2713'; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); color: white; font-size: 0.7rem; font-weight: bold; }

        .text-input { width: 100%; min-height: 120px; padding: 16px; border: 2px solid #eee; border-radius: 14px; font-family: 'Heebo', sans-serif; font-size: 0.95rem; resize: vertical; transition: border-color 0.3s; outline: none; line-height: 1.6; }
        .text-input:focus { border-color: var(--teal); }
        .text-input::placeholder { color: #ccc; }
        .char-count { text-align: left; font-size: 0.75rem; color: #bbb; margin-top: 6px; }

        .nav-buttons { display: flex; gap: 10px; margin-top: 8px; }
        .btn { flex: 1; padding: 14px 20px; border: none; border-radius: 14px; font-family: 'Heebo', sans-serif; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.25s; -webkit-tap-highlight-color: transparent; }
        .btn:active { transform: scale(0.96); }
        .btn-next { background: linear-gradient(135deg, var(--teal), var(--blue)); color: white; box-shadow: 0 4px 16px rgba(0,180,197,0.3); }
        .btn-next:hover { box-shadow: 0 6px 24px rgba(0,180,197,0.4); transform: translateY(-1px); }
        .btn-next:disabled { opacity: 0.4; cursor: not-allowed; box-shadow: none; transform: none; }
        .btn-back { background: #f0f0f0; color: #888; flex: 0.5; }
        .btn-back:hover { background: #e4e4e4; }
        .btn-submit { background: linear-gradient(135deg, var(--green), var(--teal)); color: white; box-shadow: 0 4px 16px rgba(120,184,42,0.3); }
        .btn-submit:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; transform: none; }

        .thank-you { display: none; text-align: center; padding: 40px 20px; animation: fadeUp 0.6s ease-out; }
        .thank-you.active { display: block; }
        .thank-you .confetti-wrapper { font-size: 3.5rem; margin-bottom: 16px; animation: bounce 1.5s ease-in-out infinite; }
        .thank-you h2 { font-size: 1.8rem; font-weight: 900; background: linear-gradient(135deg, var(--green), var(--teal)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 12px; }
        .thank-you p { font-size: 1rem; color: #888; line-height: 1.7; }
        .thank-you .heart { display: inline-block; animation: heartbeat 1.2s ease-in-out infinite; }
        @keyframes heartbeat { 0%,100%{transform:scale(1)} 15%{transform:scale(1.15)} 30%{transform:scale(1)} 45%{transform:scale(1.1)} }

        .confetti-piece { position: fixed; z-index: 100; width: 10px; height: 10px; border-radius: 2px; animation: confettiFall linear forwards; pointer-events: none; }
        @keyframes confettiFall { 0%{opacity:1;transform:translateY(0) rotate(0deg) scale(1)} 100%{opacity:0;transform:translateY(100vh) rotate(720deg) scale(0.5)} }

        .slide-exit { animation: slideOut 0.3s ease-in forwards; }
        @keyframes slideOut { to{opacity:0;transform:translateX(50px)} }
        .slide-enter { animation: slideIn 0.3s ease-out forwards; }
        @keyframes slideIn { from{opacity:0;transform:translateX(-50px)} to{opacity:1;transform:translateX(0)} }
        .slide-enter-back { animation: slideInBack 0.3s ease-out forwards; }
        @keyframes slideInBack { from{opacity:0;transform:translateX(50px)} to{opacity:1;transform:translateX(0)} }

        .ripple { position: relative; overflow: hidden; }
        .ripple::after { content:''; position:absolute; width:100%; height:100%; top:0; left:0; pointer-events:none; background-image:radial-gradient(circle, rgba(255,255,255,0.3) 10%, transparent 10%); background-repeat:no-repeat; background-position:50%; transform:scale(10,10); opacity:0; transition:transform 0.4s, opacity 0.6s; }
        .ripple:active::after { transform:scale(0,0); opacity:0.3; transition:0s; }

        @media(max-width:380px){ .star-rating .star{font-size:2rem} .question-card h2{font-size:0.95rem} }
    </style>
</head>
<body>

    <div class="bg-logo" id="bgLogo">
        <svg viewBox="0 0 220 215" xmlns="http://www.w3.org/2000/svg">
            <circle class="logo-part" id="lp-head" cx="110" cy="18" r="10"/>
            <rect class="logo-part" id="lp-arm-l" x="-8" y="-36" width="16" height="72" rx="8" transform="translate(82,60) rotate(-42)"/>
            <rect class="logo-part" id="lp-arm-r" x="-8" y="-36" width="16" height="72" rx="8" transform="translate(138,60) rotate(42)"/>
            <rect class="logo-part" id="lp-hand-l" x="-32" y="-8" width="64" height="16" rx="8" transform="translate(48,102)"/>
            <rect class="logo-part" id="lp-hand-r" x="-32" y="-8" width="64" height="16" rx="8" transform="translate(172,102)"/>
            <rect class="logo-part" id="lp-leg-l" x="-8" y="-46" width="16" height="92" rx="8" transform="translate(82,157) rotate(32)"/>
            <rect class="logo-part" id="lp-leg-r" x="-8" y="-46" width="16" height="92" rx="8" transform="translate(138,157) rotate(-32)"/>
        </svg>
    </div>

    <div class="container">
        <div class="header">
            <img src="logo.png" alt="×˜×›× ×•×“×¢" class="logo">
            <h1>××©×•×‘ â€” ×ª×•×›×Ÿ ×•×”×“×¨×›×”</h1>
            <div class="subtitle">×—×•×•×™×™×ª ×¤×¢×™×œ×•×ª ×•×ª×•×›×Ÿ</div>
        </div>

        <div class="progress-wrapper" id="progressWrapper">
            <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
            <div class="progress-text">
                <span id="progressLabel">×©××œ×” 1 ××ª×•×š 6</span>
                <span id="progressPercent">0%</span>
            </div>
        </div>

        <div class="intro-card" id="introCard">
            <div class="emoji">ğŸ¯</div>
            <p>×“×¢×ª×š ×¢×•×–×¨×ª ×œ× ×• ×œ×”×©×ª×¤×¨!<br>× ×©××— ×œ×©××•×¢ ××™×š ×”×™×™×ª×” ×—×•×•×™×™×ª ×”×¤×¢×™×œ×•×ª ×•×”×ª×•×›×Ÿ.<br>×™×™×§×— ×¤×—×•×ª ××“×§×” ğŸ™</p>
        </div>

        <div id="questionsContainer">

            <!-- Q1: Rating 1-5 -->
            <div class="question-slide active" data-question="1">
                <div class="question-card">
                    <div class="question-number q-color-1">1</div>
                    <h2>×¢×“ ×›××” × ×”× ×™×ª ××”×¤×¢×™×œ×•×™×•×ª / ×”×ª×¢×¨×•×›×•×ª?</h2>
                    <div class="star-rating" data-name="q1">
                        <span class="star" data-value="1">â˜…</span>
                        <span class="star" data-value="2">â˜…</span>
                        <span class="star" data-value="3">â˜…</span>
                        <span class="star" data-value="4">â˜…</span>
                        <span class="star" data-value="5">â˜…</span>
                    </div>
                    <div class="star-label" id="label-q1"></div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-next ripple" onclick="nextSlide()" id="nextBtn1" disabled>×”×‘× â†</button>
                </div>
            </div>

            <!-- Q2: Multiple choice -->
            <div class="question-slide" data-question="2">
                <div class="question-card">
                    <div class="question-number q-color-2">2</div>
                    <h2>×”×× ×”×¤×¢×™×œ×•×ª ×ª×¨××” ×œ×”×‘× ×ª×š ×¢×œ ×”× ×•×©× / ×œ××“×ª ××©×”×• ×—×“×©?</h2>
                    <div class="option-group" data-name="q2">
                        <button class="option-btn" data-value="×××•×“" onclick="selectOption(this)"><span class="circle"></span><span>×××•×“ ğŸŒŸ</span></button>
                        <button class="option-btn" data-value="×‘××™×“×” ××¡×•×™××ª" onclick="selectOption(this)"><span class="circle"></span><span>×‘××™×“×” ××¡×•×™××ª ğŸ‘</span></button>
                        <button class="option-btn" data-value="×œ× ×›×œ ×›×š" onclick="selectOption(this)"><span class="circle"></span><span>×œ× ×›×œ ×›×š ğŸ¤”</span></button>
                        <button class="option-btn" data-value="×œ×" onclick="selectOption(this)"><span class="circle"></span><span>×œ× ğŸ“</span></button>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-back" onclick="prevSlide()">â†’ ×—×–×¨×”</button>
                    <button class="btn btn-next ripple" onclick="nextSlide()" id="nextBtn2" disabled>×”×‘× â†</button>
                </div>
            </div>

            <!-- Q3: Multiple choice -->
            <div class="question-slide" data-question="3">
                <div class="question-card">
                    <div class="question-number q-color-3">3</div>
                    <h2>×”×× ×”×”×¡×‘×¨×™× ×©×œ ×”××“×¨×™×š ×”×™×• ×‘×¨×•×¨×™× ×•××•×‘× ×™×?</h2>
                    <div class="option-group" data-name="q3">
                        <button class="option-btn" data-value="×›×Ÿ, ×××•×“" onclick="selectOption(this)"><span class="circle"></span><span>×›×Ÿ, ×××•×“ ğŸŒŸ</span></button>
                        <button class="option-btn" data-value="×›×Ÿ, ×“×™" onclick="selectOption(this)"><span class="circle"></span><span>×›×Ÿ, ×“×™ ğŸ‘</span></button>
                        <button class="option-btn" data-value="×—×œ×§×™×ª" onclick="selectOption(this)"><span class="circle"></span><span>×—×œ×§×™×ª ğŸ¤”</span></button>
                        <button class="option-btn" data-value="×œ×" onclick="selectOption(this)"><span class="circle"></span><span>×œ× ğŸ“</span></button>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-back" onclick="prevSlide()">â†’ ×—×–×¨×”</button>
                    <button class="btn btn-next ripple" onclick="nextSlide()" id="nextBtn3" disabled>×”×‘× â†</button>
                </div>
            </div>

            <!-- Q4: Multiple choice -->
            <div class="question-slide" data-question="4">
                <div class="question-card">
                    <div class="question-number q-color-4">4</div>
                    <h2>×‘××™×“×” ×•×¨×œ×•×•× ×˜×™ â€” ×”×× ×”×¤×¢×™×œ×•×ª ×ª×××” ××ª ×’×™×œ××™ ×”×™×œ×“×™×?</h2>
                    <div class="option-group" data-name="q4">
                        <button class="option-btn" data-value="×ª×××” ×××•×“" onclick="selectOption(this)"><span class="circle"></span><span>×ª×××” ×××•×“ ğŸŒŸ</span></button>
                        <button class="option-btn" data-value="×›×Ÿ, ×“×™" onclick="selectOption(this)"><span class="circle"></span><span>×›×Ÿ, ×“×™ ğŸ‘</span></button>
                        <button class="option-btn" data-value="×—×œ×§×™×ª" onclick="selectOption(this)"><span class="circle"></span><span>×—×œ×§×™×ª ğŸ¤”</span></button>
                        <button class="option-btn" data-value="×œ× ×ª×××”" onclick="selectOption(this)"><span class="circle"></span><span>×œ× ×ª×××” ğŸ“</span></button>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-back" onclick="prevSlide()">â†’ ×—×–×¨×”</button>
                    <button class="btn btn-next ripple" onclick="nextSlide()" id="nextBtn4" disabled>×”×‘× â†</button>
                </div>
            </div>

            <!-- Q5: Rating 1-5 -->
            <div class="question-slide" data-question="5">
                <div class="question-card">
                    <div class="question-number q-color-5">5</div>
                    <h2>×‘××™×“×” ×•×¨×œ×•×•× ×˜×™ â€” ×¢×“ ×›××” ×”×¤×¢×™×œ×•×ª ×”×™×™×ª×” ××¢× ×™×™× ×ª ×•×‘×¨×•×¨×” ×œ×™×œ×“×™×?</h2>
                    <div class="star-rating" data-name="q5">
                        <span class="star" data-value="1">â˜…</span>
                        <span class="star" data-value="2">â˜…</span>
                        <span class="star" data-value="3">â˜…</span>
                        <span class="star" data-value="4">â˜…</span>
                        <span class="star" data-value="5">â˜…</span>
                    </div>
                    <div class="star-label" id="label-q5"></div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-back" onclick="prevSlide()">â†’ ×—×–×¨×”</button>
                    <button class="btn btn-next ripple" onclick="nextSlide()" id="nextBtn5" disabled>×”×‘× â†</button>
                </div>
            </div>

            <!-- Q6: Open text -->
            <div class="question-slide" data-question="6">
                <div class="question-card">
                    <div class="question-number q-color-6">6</div>
                    <h2>××” ×”×›×™ ××”×‘×ª ×‘×¤×¢×™×œ×•×ª? ××” ×”×™×™×ª ××©×¤×¨?</h2>
                    <textarea class="text-input" data-name="q6" placeholder="× ×©××— ×œ×©××•×¢ ××ª ×“×¢×ª×š..." maxlength="500" oninput="updateCharCount(this)"></textarea>
                    <div class="char-count"><span id="charCount">0</span> / 500</div>
                </div>
                <div class="nav-buttons">
                    <button class="btn btn-back" onclick="prevSlide()">â†’ ×—×–×¨×”</button>
                    <button class="btn btn-submit ripple" onclick="submitForm()">×©×œ×™×—×ª ×”××©×•×‘ âœ¨</button>
                </div>
            </div>
        </div>

        <div class="thank-you" id="thankYou">
            <div class="confetti-wrapper">ğŸ‰</div>
            <h2>×ª×•×“×” ×¨×‘×”!</h2>
            <p>×”××©×•×‘ ×©×œ×š ×”×ª×§×‘×œ ×‘×”×¦×œ×—×”.<br>×× ×—× ×• ×‘×˜×›× ×•×“×¢ ×¢×•×‘×“×™× ×›×œ ×”×–××Ÿ ×œ×”×©×ª×¤×¨,<br>×•×”××©×•×‘ ×©×œ×š ×¢×•×–×¨ ×œ× ×• ×××•×“ <span class="heart">â¤ï¸</span></p>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
        const firebaseConfig = {
            apiKey: "AIzaSyBQ82MgwWCmMaEQQbyCKc_O2sA4i3tJ8ZI",
            authDomain: "forme-a3c26.firebaseapp.com",
            databaseURL: "https://forme-a3c26-default-rtdb.firebaseio.com",
            projectId: "forme-a3c26",
            storageBucket: "forme-a3c26.firebasestorage.app",
            messagingSenderId: "1026375487564",
            appId: "1:1026375487564:web:6a275bacad937a283ba4e9"
        };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        window.submitToFirebase = async function(data) {
            try { await push(ref(db, 'mevakrim/mashov2'), data); return true; }
            catch(e) { console.error(e); return false; }
        };
    </script>

    <script>
        const logoParts = ['lp-head','lp-arm-l','lp-arm-r','lp-hand-l','lp-hand-r','lp-leg-l','lp-leg-r'];
        const slideColorThemes = [
            ['#00B4C5','#78B82A','#0080C9','#6D3078','#FDC300','#E6007E','#F39200'],
            ['#78B82A','#F39200','#E6007E','#00B4C5','#0080C9','#FDC300','#6D3078'],
            ['#F39200','#6D3078','#FDC300','#78B82A','#E6007E','#0080C9','#00B4C5'],
            ['#6D3078','#E6007E','#00B4C5','#F39200','#78B82A','#0080C9','#FDC300'],
            ['#FDC300','#0080C9','#78B82A','#E6007E','#F39200','#6D3078','#00B4C5'],
            ['#E6007E','#00B4C5','#6D3078','#FDC300','#0080C9','#78B82A','#F39200'],
        ];
        function updateLogoColors(idx) {
            const c = slideColorThemes[idx-1] || slideColorThemes[0];
            logoParts.forEach((id,i) => { const el=document.getElementById(id); if(el) el.style.fill=c[i]; });
        }

        let currentSlide = 1;
        const totalSlides = 6;
        const answers = {};
        const starLabels = {1:'×‘×›×œ×œ ×œ×',2:'××¢×˜',3:'×‘×™× ×•× ×™',4:'×˜×•×‘ ×××•×“',5:'××¦×•×™×Ÿ!'};
        const starColors = {1:'#EF5350',2:'#FF7043',3:'#FFA726',4:'#66BB6A',5:'#26A69A'};

        document.querySelectorAll('.star-rating').forEach(group => {
            const name = group.dataset.name;
            const stars = group.querySelectorAll('.star');
            const label = document.getElementById('label-' + name);
            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const val = parseInt(star.dataset.value);
                    answers[name] = val;
                    stars.forEach(s => {
                        const v = parseInt(s.dataset.value);
                        s.style.color = v <= val ? starColors[val] : '#ddd';
                        if (v <= val) s.classList.add('active'); else s.classList.remove('active');
                    });
                    if (label) { label.textContent = starLabels[val]; label.classList.add('visible'); }
                    enableNextButton();
                });
                star.addEventListener('mouseenter', () => {
                    const val = parseInt(star.dataset.value);
                    stars.forEach(s => { if(parseInt(s.dataset.value)<=val) s.classList.add('hovered'); });
                });
                star.addEventListener('mouseleave', () => stars.forEach(s => s.classList.remove('hovered')));
            });
        });

        function selectOption(btn) {
            const group = btn.closest('.option-group');
            group.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            answers[group.dataset.name] = btn.dataset.value;
            enableNextButton();
        }
        function enableNextButton() {
            const btn = document.getElementById('nextBtn' + currentSlide);
            if (btn && answers['q' + currentSlide]) btn.disabled = false;
        }
        function nextSlide() {
            if (currentSlide >= totalSlides) return;
            const current = document.querySelector(`.question-slide[data-question="${currentSlide}"]`);
            current.classList.add('slide-exit');
            setTimeout(() => {
                current.classList.remove('active','slide-exit');
                currentSlide++;
                const next = document.querySelector(`.question-slide[data-question="${currentSlide}"]`);
                next.classList.add('active','slide-enter');
                updateProgress(); updateLogoColors(currentSlide);
                if (currentSlide === 2) {
                    const intro = document.getElementById('introCard');
                    intro.style.transition='all 0.4s ease'; intro.style.opacity='0';
                    intro.style.maxHeight='0'; intro.style.padding='0';
                    intro.style.margin='0'; intro.style.overflow='hidden';
                }
                setTimeout(() => next.classList.remove('slide-enter'), 400);
            }, 300);
        }
        function prevSlide() {
            if (currentSlide <= 1) return;
            const current = document.querySelector(`.question-slide[data-question="${currentSlide}"]`);
            current.style.animation='none'; current.offsetHeight; current.style.animation='';
            current.classList.remove('active');
            currentSlide--;
            const prev = document.querySelector(`.question-slide[data-question="${currentSlide}"]`);
            prev.classList.add('active','slide-enter-back');
            updateProgress(); updateLogoColors(currentSlide);
            setTimeout(() => prev.classList.remove('slide-enter-back'), 400);
        }
        function updateProgress() {
            const pct = Math.round(((currentSlide-1)/totalSlides)*100);
            document.getElementById('progressFill').style.width = pct+'%';
            document.getElementById('progressLabel').textContent = `×©××œ×” ${currentSlide} ××ª×•×š ${totalSlides}`;
            document.getElementById('progressPercent').textContent = pct+'%';
        }
        function updateCharCount(ta) { document.getElementById('charCount').textContent = ta.value.length; }
        async function submitForm() {
            const textarea = document.querySelector('textarea[data-name="q6"]');
            if (textarea.value.trim()) answers.q6 = textarea.value.trim();
            const submitBtn = document.querySelector('.btn-submit');
            submitBtn.disabled = true; submitBtn.textContent = '×©×•×œ×—...';
            const surveyData = {
                timestamp: new Date().toISOString(),
                q1_enjoyment: answers.q1 || null,
                q2_learned_something: answers.q2 || null,
                q3_guide_clarity: answers.q3 || null,
                q4_age_appropriate: answers.q4 || null,
                q5_interesting_for_kids: answers.q5 || null,
                q6_feedback: answers.q6 || ''
            };
            let success = false;
            if (window.submitToFirebase) success = await window.submitToFirebase(surveyData);
            if (!success) console.log('Fallback:', surveyData);
            document.getElementById('questionsContainer').style.display = 'none';
            document.getElementById('introCard').style.display = 'none';
            document.getElementById('progressWrapper').style.display = 'none';
            document.getElementById('thankYou').classList.add('active');
            launchConfetti();
        }
        function launchConfetti() {
            const colors=['#E6007E','#00B4C5','#F39200','#6D3078','#0080C9','#78B82A','#FDC300'];
            for (let i=0;i<60;i++) setTimeout(() => {
                const p=document.createElement('div'); p.className='confetti-piece';
                p.style.left=Math.random()*100+'vw'; p.style.top='-10px';
                p.style.background=colors[Math.floor(Math.random()*colors.length)];
                p.style.width=(Math.random()*8+5)+'px'; p.style.height=(Math.random()*8+5)+'px';
                p.style.borderRadius=Math.random()>0.5?'50%':'2px';
                p.style.animationDuration=(Math.random()*2+2)+'s';
                document.body.appendChild(p); setTimeout(()=>p.remove(),4000);
            }, i*30);
        }
        updateProgress(); updateLogoColors(1);
    </script>
</body>
</html>
